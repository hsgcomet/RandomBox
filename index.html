<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ìƒì¼ ì„ ë¬¼ ë½‘ê¸°</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0a0d2b;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }
    .container {
      margin-top: 30px;
      width: 400px;
      background: #151a3a;
      border: 4px solid gold;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 0 30px #000a, inset 0 0 20px gold;
      text-align: center;
    }
    h1 {
      font-size: 2rem;
      color: gold;
    }
    #coinDisplay {
      margin-bottom: 10px;
      font-size: 1.1rem;
      color: #0ff;
    }
    .box-option {
      width: 100px;
      height: 120px;
      background: #1e2547;
      border-radius: 15px;
      cursor: pointer;
      margin: 10px;
      display: inline-block;
      box-shadow: 0 0 10px #0af;
    }
    .box-option.selected {
      border: 3px solid gold;
      box-shadow: 0 0 20px gold;
    }
    .box-option img {
      width: 70px;
      margin-top: 10px;
    }
    .box-option span {
      display: block;
      margin-top: 5px;
      color: #a6d7ff;
    }
    button {
      margin-top: 15px;
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      font-weight: bold;
      border-radius: 10px;
      cursor: pointer;
    }
    #draw1Btn {
      background: linear-gradient(45deg, gold, #ffec8b);
      color: #333;
      border: none;
      box-shadow: 0 0 10px gold;
    }
    #draw10Btn {
      background: #444;
      color: #fff;
      border: 2px solid #0af;
    }
    .draw-screen {
      position: fixed;
      top: 0;
      left:  0;
      width: 100vw;
      height: 100vh;
      background: radial-gradient(circle, #001018, #000);
      z-index: 9999;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .draw-team {
      font-size: 2rem;
      font-weight: bold;
      text-shadow: 0 0 30px;
      margin-bottom: 20px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .draw-item {
      text-align: center;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .draw-item img {
      width: 160px;
      height: 160px;
      object-fit: contain;
      margin-bottom: 10px;
      border-radius: 20px;
      box-shadow: 0 0 25px gold;
    }
    .draw-item .name {
      font-size: 1.8rem;
      text-shadow: 0 0 15px;
      font-weight: bold;
    }
    #resultGrid .result-card {
      width: 100px;
      text-align: center;
      background: #1e2547;
      padding: 10px;
      border-radius: 15px;
      box-shadow: 0 0 10px #0af;
    }
    #resultGrid .result-card img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>RPG ëœë¤ ë°•ìŠ¤</h1>
    <div id="coinDisplay">ì½”ì¸: <span id="coinAmount">0</span></div>

    <div id="boxSelectArea">
      <div class="box-option selected" data-box="normal">
        <img src="ë°•ì†Œì›ìƒì¼/ë‹¤ìš´ë¡œë“œ.png" />
        <span>ì¼ë°˜</span>
      </div>
      <div class="box-option" data-box="premium">
        <img src="ë°•ì†Œì›ìƒì¼/ë‹¤ìš´ë¡œë“œ (1).png" />
        <span>ê³ ê¸‰</span>
      </div>
      <div class="box-option" data-box="legendary">
        <img src="ë°•ì†Œì›ìƒì¼/ë‹¤ìš´ë¡œë“œ (2).png" />
        <span>ì „ì„¤</span>
      </div>
    </div>

    <button id="draw1Btn">1íšŒ ë½‘ê¸°</button>
    <button id="draw10Btn">10íšŒ ë½‘ê¸°</button>

    <div id="drawCostDisplay" style="margin-top: 10px; font-size: 0.95rem; color: #aaa;">
      ğŸ’° 1íšŒ: 100 / 10íšŒ: 1000
    </div>

    <button onclick="resetData()" style="background:#b00; color:#fff; font-weight:bold;">ë¦¬ì…‹</button>
    <button onclick="location.href='inventory.html'" style="margin-top:10px;">ì¸ë²¤í† ë¦¬</button>
    <button onclick="location.href='setting.html'" style="margin-top:10px;">ì„¤ì •</button>
  </div>

  <div class="draw-screen" id="drawScreen">
    <div class="draw-team" id="drawTeam"></div>
    <div class="draw-item" id="drawItem">
      <img src="" id="drawItemImg" />
      <div class="name" id="drawItemName"></div>
    </div>
  </div>

  <div class="draw-screen" id="drawResults">
    <div class="draw-team" id="multiDrawMessage">ì¤‘ë³µ ì•„ì´í…œ</div>
    <div id="resultGrid" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;"></div>
    <button onclick="hideDrawResults()" style="margin-top: 20px; padding: 10px 20px; font-weight: bold;">ë‹«ê¸°</button>
  </div>

  <audio id="soundStart" src="sounds/3.mp3" preload="auto"></audio>
  <audio id="soundText" src="sounds/2.mp3" preload="auto"></audio>
  <audio id="soundFinal" src="sounds/1.mp3" preload="auto"></audio>

  <script>


    // âœ… localStorage ê¸°ë°˜ ì €ì¥ í•¨ìˆ˜
    function getData(name) {
      const value = localStorage.getItem(name);
      return value ? decodeURIComponent(value) : null;
    }

    function setData(name, value) {
      localStorage.setItem(name, encodeURIComponent(value));
    }
    const grades = {
      common:  { name: "ì¼ë°˜", color: "#ccc" },
      rare:    { name: "í¬ê·€", color: "#4ae" },
      epic:    { name: "ì´ˆí¬ê·€", color: "#b4f" },
      hero:    { name: "ì˜ì›…", color: "#f93" },
      myth:    { name: "ì‹ í™”", color: "#ff0" },
      legend:  { name: "ì „ì„¤", color: "#f00" }
    };

    const boxes = {
      normal: [
        { name: "ì–‘ìŠ¹ë¯¼ ì˜† ëª¨ìŠµ", image: "ë°•ì†Œì›ìƒì¼/1.jpg", grade: "common", chance: 50, messages: ["ì—‡! ë²„ìŠ¤ì— ë¬´ì–¸ê°€..", "ì´ê±´... ë¹¨ê°„ìƒ‰!"] },
        { name: "ê·¸ëƒ¥ í° ë°°ê²½", image: "ë°•ì†Œì›ìƒì¼/2.jpg", grade: "common", chance: 30, messages: ["í°ìƒ‰ì˜!", "ì•„ë¬´ê²ƒë„ ì—†ëŠ”!"] },
        { name: "ë°•ì†Œì› ë¦¬ì¦ˆ ì‹œì ˆ", image: "ë°•ì†Œì›ìƒì¼/3.jpg", grade: "rare", chance: 5, messages: ["ìª¼ê·¸ë§Œí•œ!", "ê·€ì—¬..ã…‡"] },
        { name: "í•´ì •ì´ì˜ ê½ƒ", image: "ë°•ì†Œì›ìƒì¼/4.jpg", grade: "rare", chance: 5, messages: ["ì—„ì²­ ì´ìœ!", "í™”ë ¤í•œ!"] },
        { name: "ê³°ëŒì´ ì°°ì¹µ!", image: "ë°•ì†Œì›ìƒì¼/5.jpg", grade: "rare", chance: 5, messages: ["ì•„ì£¼ì•„ì£¼ ê·€ì—¬ìš´!", "ì• ê¸°ê³°!"] },
        { name: "í•©ê¸°ë„ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/6.jpg", grade: "rare", chance: 5, messages: ["ë„ë³µì˜!", "í•©ê¸°ë„!"] },

    ],
      premium: [
        { name: "ì–‘ìŠ¹ë¯¼ ì˜† ëª¨ìŠµ", image: "ë°•ì†Œì›ìƒì¼/1.jpg", grade: "common", chance: 10, messages: ["ì—‡! ë²„ìŠ¤ì— ë¬´ì–¸ê°€..", "ì´ê±´... ë¹¨ê°„ìƒ‰!"] },
        { name: "ê·¸ëƒ¥ í° ë°°ê²½", image: "ë°•ì†Œì›ìƒì¼/2.jpg", grade: "common", chance: 5, messages: ["í°ìƒ‰ì˜!", "ì•„ë¬´ê²ƒë„ ì—†ëŠ”!"] },
        { name: "ë°•ì†Œì› ë¦¬ì¦ˆ ì‹œì ˆ", image: "ë°•ì†Œì›ìƒì¼/3.jpg", grade: "rare", chance: 5, messages: ["ìª¼ê·¸ë§Œí•œ!", "ê·€ì—¬..ã…‡"] },
        { name: "í•´ì •ì´ì˜ ê½ƒ", image: "ë°•ì†Œì›ìƒì¼/4.jpg", grade: "rare", chance: 10, messages: ["ì—„ì²­ ì´ìœ!", "í™”ë ¤í•œ!"] },
        { name: "ê³°ëŒì´ ì°°ì¹µ!", image: "ë°•ì†Œì›ìƒì¼/5.jpg", grade: "rare", chance: 10, messages: ["ì•„ì£¼ì•„ì£¼ ê·€ì—¬ìš´!", "ì• ê¸°ê³°!"] },
        { name: "í•©ê¸°ë„ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/6.jpg", grade: "rare", chance: 10, messages: ["ë„ë³µì˜!", "í•©ê¸°ë„!"] },
        { name: "ì‹œë°œë…„ ì •ì•„ì˜", image: "ë°•ì†Œì›ìƒì¼/7.jpg", grade: "epic", chance: 5, messages: ["í‚¤ ã…ˆã„´ ì‘ì€!", "ã……ã…‚ë…„!"] },
        { name: "ë°”ë¥¸ ë‚˜ë¬´ ìœ„ì›íšŒ", image: "ë°•ì†Œì›ìƒì¼/8.jpg", grade: "epic", chance: 5, messages: ["ë°”ë¥¸!", "ë‚˜ë¬´ ìœ„ì›íšŒ!"] },
        { name: "ì¹´í›— 3ë“±", image: "ë°•ì†Œì›ìƒì¼/9.jpg", grade: "epic", chance: 5, messages: ["í•´ì •ì´ì˜!", "3ë“±ìƒ!"] },
        { name: "ì¼ë¯¼í€ì¹˜", image: "ë°•ì†Œì›ìƒì¼/10.jpg", grade: "epic", chance: 10, messages: ["ë°›ì•„ë¼!", "ì¼ë¯¼ì´ì˜!"] },
        { name: "ë¹„ëˆ—ë°©ìš¸ ë°•ì€ì •", image: "ë°•ì†Œì›ìƒì¼/11.jpg", grade: "hero", chance: 3, messages: ["ëª»ìƒê¸´!", "ë¹„ëˆ—ë°©ìš¸ ì†!"] },
        { name: "ê°ì„±ì¶© í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/12.jpg", grade: "hero", chance: 1, messages: ["í•œ ë‚¨ìì˜", "ìŠ¬í”ˆ ì´ì•¼ê¸°.."] },
        { name: "ìŠˆí¼ ë‹¹ë‹¹ í•´ì •", image: "ë°•ì†Œì›ìƒì¼/13.jpg", grade: "hero", chance: 3, messages: ["ì‚¬ë‚˜ì´ë¡œ!", "íƒœì–´ë‚˜ì„œ!"] },
        { name: "ì‹œë°œ ë°•ì€ì •", image: "ë°•ì†Œì›ìƒì¼/14.jpg", grade: "hero", chance: 3, messages: ["ìš•", "ì„¤"] },
        { name: "ğŸ«§ğŸ«§", image: "ë°•ì†Œì›ìƒì¼/15.jpg", grade: "hero", chance: 3, messages: ["ğŸ«§ğŸ«§ğŸ«§ğŸ«§ğŸ«§", "ğŸ«§ğŸ«§ğŸ«§ğŸ«§ğŸ«§"] },
        { name: "ê³ ë¯¼ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/16.jpg", grade: "hero", chance: 3, messages: ["...", "..."] },
        { name: "ë‚ ì•„ì˜¤ë¥´ë¼~", image: "ë°•ì†Œì›ìƒì¼/17.jpg", grade: "myth", chance: 2, messages: ["ë‚ ì•„ì˜¤ë¥´ë¼~", "ì£¼ì‘ì´ì—¬~"] },
        { name: "ì„¸ë¡œ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/18.jpg", grade: "myth", chance: 1, messages: ["ì„¸ë¡œë¡œ", "ì§§ì€"] },
        { name: "ì´ìƒí•œ ì• ë“¤", image: "ë°•ì†Œì›ìƒì¼/19.jpg", grade: "myth", chance: 1, messages: ["í•´ì •ì´,ë°•ì€ì •", "ë°•ì†Œì›"] },
        { name: "ë„ì´¬ ê¸ˆì§€!", image: "ë°•ì†Œì›ìƒì¼/20.jpg", grade: "myth", chance: 1, messages: ["ì—°ì˜ˆì¸ì´ì—ìš”", "ì°ì§€ë§ˆì„¸ìš”!!"] },
        { name: "ë°‹ë°‹í•œ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/21.jpg", grade: "myth", chance: 1, messages: ["ì—¥..", "ë°‹ë°‹í•´.."] },
        { name: "ë‚˜ ì‚¬ì‹¤ ë‚¨ìì„ ã…‹", image: "ë°•ì†Œì›ìƒì¼/22.jpg", grade: "myth", chance: 1, messages: ["ë‚˜ ì‚¬ì‹¤ ë‚¨ìì„", "ë§Œìš°ì ˆ~"] },
        { name: "í™”ê°€ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/23.jpg", grade: "myth", chance: 1, messages: ["ê°œì©ŒëŠ”!!!!", "í•´ì •ì´ì˜..!"] },
        { name: "ë¹µê¸‹ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/24.jpg", grade: "myth", chance: 1, messages: ["ì ì›ƒìœ¼ì„¸ìš”", "ì¹˜ì¦ˆ~"] },
        { name: "ê¸°ê´´í•œ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/25.jpg", grade: "myth", chance: 1, messages: ["ì˜¤ì˜¤", "ê¸°ê´´í•´"] },
        { name: "ì²´ìœ¡ë³µ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/26.jpg", grade: "myth", chance: 1, messages: ["íŒ¨ì…˜êµ¿", "ì²´ìœ¡ë³µì˜"] },
        


      ],
      legendary: [
        { name: "ì‹œë°œë…„ ì •ì•„ì˜", image: "ë°•ì†Œì›ìƒì¼/7.jpg", grade: "epic", chance: 11, messages: ["í‚¤ ã…ˆã„´ ì‘ì€!", "ã……ã…‚ë…„!"] },
        { name: "ë°”ë¥¸ ë‚˜ë¬´ ìœ„ì›íšŒ", image: "ë°•ì†Œì›ìƒì¼/8.jpg", grade: "epic", chance: 11, messages: ["ë°”ë¥¸!", "ë‚˜ë¬´ ìœ„ì›íšŒ!"] },
        { name: "ì¹´í›— 3ë“±", image: "ë°•ì†Œì›ìƒì¼/9.jpg", grade: "epic", chance: 11, messages: ["í•´ì •ì´ì˜!", "3ë“±ìƒ!"] },
        { name: "ì¼ë¯¼í€ì¹˜", image: "ë°•ì†Œì›ìƒì¼/10.jpg", grade: "epic", chance: 11, messages: ["ë°›ì•„ë¼!", "ì¼ë¯¼ì´ì˜!"] },
        { name: "ë¹„ëˆ—ë°©ìš¸ ë°•ì€ì •", image: "ë°•ì†Œì›ìƒì¼/11.jpg", grade: "hero", chance: 3, messages: ["ëª»ìƒê¸´!", "ë¹„ëˆ—ë°©ìš¸ ì†!"] },
        { name: "ê°ì„±ì¶© í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/12.jpg", grade: "hero", chance: 3, messages: ["í•œ ë‚¨ìì˜", "ìŠ¬í”ˆ ì´ì•¼ê¸°.."] },
        { name: "ìŠˆí¼ ë‹¹ë‹¹ í•´ì •", image: "ë°•ì†Œì›ìƒì¼/13.jpg", grade: "hero", chance: 3, messages: ["ì‚¬ë‚˜ì´ë¡œ!", "íƒœì–´ë‚˜ì„œ!"] },
        { name: "ì‹œë°œ ë°•ì€ì •", image: "ë°•ì†Œì›ìƒì¼/14.jpg", grade: "hero", chance: 3, messages: ["ìš•", "ì„¤"] },
        { name: "ğŸ«§ğŸ«§", image: "ë°•ì†Œì›ìƒì¼/15.jpg", grade: "hero", chance: 3, messages: ["ğŸ«§ğŸ«§ğŸ«§ğŸ«§ğŸ«§", "ğŸ«§ğŸ«§ğŸ«§ğŸ«§ğŸ«§"] },
        { name: "ê³ ë¯¼ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/16.jpg", grade: "hero", chance: 3, messages: ["...", "..."] },
        { name: "ë‚ ì•„ì˜¤ë¥´ë¼~", image: "ë°•ì†Œì›ìƒì¼/17.jpg", grade: "myth", chance: 2, messages: ["ë‚ ì•„ì˜¤ë¥´ë¼~", "ì£¼ì‘ì´ì—¬~"] },
        { name: "ì„¸ë¡œ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/18.jpg", grade: "myth", chance: 1, messages: ["ì„¸ë¡œë¡œ", "ì§§ì€"] },
        { name: "ì´ìƒí•œ ì• ë“¤", image: "ë°•ì†Œì›ìƒì¼/19.jpg", grade: "myth", chance: 1, messages: ["í•´ì •ì´,ë°•ì€ì •", "ë°•ì†Œì›"] },
        { name: "ë„ì´¬ ê¸ˆì§€!", image: "ë°•ì†Œì›ìƒì¼/20.jpg", grade: "myth", chance: 1, messages: ["ì—°ì˜ˆì¸ì´ì—ìš”", "ì°ì§€ë§ˆì„¸ìš”!!"] },
        { name: "ë°‹ë°‹í•œ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/21.jpg", grade: "myth", chance: 1, messages: ["ì—¥..", "ë°‹ë°‹í•´.."] },
        { name: "ë‚˜ ì‚¬ì‹¤ ë‚¨ìì„ ã…‹", image: "ë°•ì†Œì›ìƒì¼/22.jpg", grade: "myth", chance: 1, messages: ["ë‚˜ ì‚¬ì‹¤ ë‚¨ìì„", "ë§Œìš°ì ˆ~"] },
        { name: "í™”ê°€ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/23.jpg", grade: "myth", chance: 1, messages: ["ê°œì©ŒëŠ”!!!!", "í•´ì •ì´ì˜..!"] },
        { name: "ë¹µê¸‹ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/24.jpg", grade: "myth", chance: 1, messages: ["ì ì›ƒìœ¼ì„¸ìš”", "ì¹˜ì¦ˆ~"] },
        { name: "ê¸°ê´´í•œ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/25.jpg", grade: "myth", chance: 1, messages: ["ì˜¤ì˜¤", "ê¸°ê´´í•´"] },
        { name: "ì²´ìœ¡ë³µ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/26.jpg", grade: "myth", chance: 1, messages: ["íŒ¨ì…˜êµ¿", "ì²´ìœ¡ë³µì˜"] },
        { name: "ì…˜ì¸ìŸ", image: "ë°•ì†Œì›ìƒì¼/27.jpg", grade: "myth", chance: 2, messages: ["ì‘ë…„ì˜..", "ì„ ë¬¼!!"] },
        { name: "ê²¨ìš¸ë‚  í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/28.jpg", grade: "myth", chance: 2, messages: ["ì•„ì‡ì¶”ì›Œ!", "ê²¨ìš¸ë‹"] },
        { name: "êº¼ì–µ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/29.jpg", grade: "myth", chance: 2, messages: ["ë‹¤ ë“¤ì–´ì™€~", "ë‹¤ ë¨¹ì–´ì£¼ì§€!!"] },
        { name: "ëˆˆê¹” ë°•ì€ì •", image: "ë°•ì†Œì›ìƒì¼/30.jpg", grade: "myth", chance: 2, messages: ["ì•¼ ë„ˆ ë­˜ ë´", "ê¼½ëƒ? ã…‹"] },
        { name: "í‚¤ ì»¤ì ¸ë¼! ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/31.jpg", grade: "myth", chance: 2, messages: ["í‚¤ í¬ê¸° ìš´ë™", "ì‹œì‘!"] },
        { name: "ë¸”ë£¨í•´ì •", image: "ë°•ì†Œì›ìƒì¼/32.jpg", grade: "myth", chance: 2, messages: ["í•´ì •ì´ì˜", "ë¸”ë£¨ìƒ‰!"] },
        { name: "ì£¼ì§“ì¸ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/33.jpg", grade: "myth", chance: 2, messages: ["ì£¼ì§“ìˆ˜", "ì§‘ì—ê°€ë‹¤.."] },
        { name: "ì™•ê´€ë¹¨ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/34.jpg", grade: "myth", chance: 1, messages: ["ì´ˆí†µë ¹(?)", "í•´ì •ì´ì˜"] },
        { name: "ë‹¨ë°œ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/35.jpg", grade: "myth", chance: 2, messages: ["ë‚˜ëŠ”", "ë°•ì†Œì›"] },
        { name: "ìš¸ì§‘ ê°•ì•„ì§€", image: "ë°•ì†Œì›ìƒì¼/36.jpg", grade: "myth", chance: 1, messages: ["ì‚¬ë‘í•´~", "ìš¸ì§‘ê°•ì•„ì§€~"] },
        { name: "ìš¸ì§‘ ê°•ì•„ì§€1", image: "ë°•ì†Œì›ìƒì¼/37.jpg", grade: "myth", chance: 1, messages: ["ì‚¬ë‘í•´~", "ìš¸ì§‘ê°•ì•„ì§€~"] },
        { name: "ì¹˜ì¦ˆ ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/38.jpg", grade: "myth", chance: 2, messages: ["ì—¬ê¸°ë³´ì„¸ìš”", "ì¹˜ì¦ˆ~!"] },
        { name: "ê°œì¡¸ë¦° í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/39.jpg", grade: "myth", chance: 1, messages: ["ë„¤?", "ì•„ ë„¤.."] },
        { name: "ëª»ìƒê¸´ í•´ì •ì´", image: "ë°•ì†Œì›ìƒì¼/40.jpg", grade: "myth", chance: 1, messages: ["ã…ˆã„´ ì´ìƒí•´", "ì™œì €ë˜"] },
        { name: "?? ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/41.jpg", grade: "myth", chance: 2, messages: ["í‚¤ìŠ¤í•˜ëŠ”(?)", "ë°•ì†Œì›!"] },
        { name: "ê¸°ê¹”ë‚˜ëŠ” ë°•ì†Œì›", image: "ë°•ì†Œì›ìƒì¼/42.jpg", grade: "myth", chance: 1.5, messages: ["ê¸°ê¹”ë‚˜ëŠ”", "ë°”ì•…ì†Œì˜¤ì›Œì–¸"] },
        { name: "ìƒì¼ ì¶•í•˜ í•©ë‹ˆë‹¤~", image: "ë°•ì†Œì›ìƒì¼/43.jpg", grade: "legend", chance: 0.5, messages: ["ë°•ì†Œì›", "ìƒì¼ì¶•í•˜ìš”~"] },

        
      ]
    };

    const drawCosts = {
      normal: { one: 100, ten: 1000 },
      premium: { one: 3000, ten: 30000 },
      legendary: { one: 99999, ten: 1000000 }
    };

    const selectedBoxState = { value: "normal" };

    function getAllItems() {
      return Object.values(boxes).flat();
    }

    function initInventory() {
      if (getData("inventory")) return;

      const allItems = getAllItems();
      const inventory = [];

      allItems.forEach(item => {
        if (!inventory.some(i => i.name === item.name && i.image === item.image)) {
          inventory.push({ name: item.name, image: item.image, grade: item.grade, count: 0 });
        }
      });

      setData("inventory", JSON.stringify(inventory));
    }

    function resetData() {
      if (confirm("ì •ë§ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        setData("coins", "1000");
        setData("inventory", "[]");
        updateCoinDisplay();
      }
    }

    function initCoins() {
      if (!getData("coins")) setData("coins", "1000");
    }

    function updateCoinDisplay() {
      document.getElementById("coinAmount").textContent = getData("coins") || "0";
    }

    function getInventory() {
      const inv = getData("inventory");
      return inv ? JSON.parse(inv) : [];
    }

    function saveInventory(inventory) {
      setData("inventory", JSON.stringify(inventory));
    }

    function saveToInventory(item) {
      let inventory = getInventory();
      const existing = inventory.find(i => i.name === item.name && i.image === item.image);

      if (existing) {
        existing.count++;
      } else {
        if (inventory.length >= 50) {
          console.warn("ì¸ë²¤í† ë¦¬ê°€ ê°€ë“ ì°¼ìŠµë‹ˆë‹¤: 50ì¢…ë¥˜ ì œí•œ");
          return false;
        }
        inventory.push({ ...item, count: 1 });
      }

      inventory.sort((a, b) => a.name.localeCompare(b.name));
      saveInventory(inventory);
      return true;
    }

function updateDrawCostText() {
  const cost = drawCosts[selectedBoxState.value];
  document.getElementById("drawCostDisplay").textContent =
    `ğŸ’° 1íšŒ: ${cost.one.toLocaleString()} / 10íšŒ: ${cost.ten.toLocaleString()}`;
}









    function playSound(id) {
      if (getCookie("sound") === "off") return;
      const audio = document.getElementById(id);
      if (audio) {
        audio.currentTime = 0;
        audio.play().catch(() => {});
      }
    }

    function getRandomItem(boxType) {
      const pool = boxes[boxType];
      const weighted = [];
      pool.forEach(item => {
        for (let i = 0; i < item.chance; i++) weighted.push(item);
      });
      return weighted[Math.floor(Math.random() * weighted.length)];
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function showDrawAnimation(item, isLast = false) {
  const gradeInfo = grades[item.grade];
  const drawScreen = document.getElementById("drawScreen");
  const drawTeam = document.getElementById("drawTeam");
  const drawItem = document.getElementById("drawItem");
  const drawItemImg = document.getElementById("drawItemImg");
  const drawItemName = document.getElementById("drawItemName");

  // ì´ˆê¸°í™”
  drawScreen.style.display = "flex";
  drawItem.style.opacity = "0";
  drawTeam.style.opacity = "0";
  drawItemImg.src = ""; // ì´ˆê¸°í™” (ì¤‘ìš”)
  drawItemName.textContent = "";

  const [msg1, msg2] = item.messages || ["ì•„ì´í…œ íšë“!", ""];

  drawTeam.textContent = msg1;
  drawTeam.style.color = gradeInfo.color;

  try {
    const textSound = document.getElementById("soundText");
    textSound.currentTime = 0;
    await textSound.play();
  } catch (e) {}

  // ì²« ë²ˆì§¸ ë©”ì‹œì§€
  drawTeam.style.opacity = "1";
  await sleep(1000);

  drawTeam.style.opacity = "0";
  await sleep(300);

  // ë‘ ë²ˆì§¸ ë©”ì‹œì§€
  drawTeam.textContent = msg2;
  drawTeam.style.opacity = "1";
  await sleep(1000);

  // ë©”ì‹œì§€ ìˆ¨ê¸°ê³  ì´ë¯¸ì§€/ì´ë¦„ í‘œì‹œ
  drawTeam.style.opacity = "0";
  await sleep(200);

  drawItemImg.src = item.image;
  drawItemName.textContent = item.name;
  drawItemName.style.color = gradeInfo.color;
  drawItemName.style.textShadow = `0 0 15px ${gradeInfo.color}`;
  drawItem.style.opacity = "1";

  if (isLast) {
    try {
      const finalSound = document.getElementById("soundFinal");
      finalSound.currentTime = 0;
      await finalSound.play();
    } catch (e) {}
  }

  await sleep(1200);
  drawScreen.style.display = "none";
}


    
async function draw(times) {
  const cost = drawCosts[selectedBoxState.value];
  const totalCost = times === 1 ? cost.one : cost.ten;
  let coin = parseInt(getData("coins"));
  if (coin < totalCost) {
    alert("ì½”ì¸ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");
    return;
  }

  const inventory = getInventory();
  const ownedNames = inventory.map(i => i.name);
  const newItems = [];
  const duplicateItems = [];

 for (let i = 0; i < times; i++) {
  const item = getRandomItem(selectedBoxState.value);
  const alreadyOwned = ownedNames.includes(item.name);
  const saved = saveToInventory(item);

  if (!saved) {
    alert("ì¸ë²¤í† ë¦¬ì— ì•„ì´í…œì„ ë” ì´ìƒ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n(ìµœëŒ€ 50ì¢…ë¥˜)");
    break; // ì €ì¥ ì•ˆë˜ë©´ ì¤‘ë‹¨
  }

  if (alreadyOwned) {
    duplicateItems.push(item);
  } else {
    newItems.push(item);
    ownedNames.push(item.name);
  }
}


  setData("coins", String(coin - totalCost));
  updateCoinDisplay();

  // ì¤‘ë³µ ì•„ë‹Œ ì•„ì´í…œ: ì• ë‹ˆë©”ì´ì…˜
  for (let i = 0; i < newItems.length; i++) {
    const isLast = (i === newItems.length - 1) && duplicateItems.length === 0;
    await showDrawAnimation(newItems[i], isLast);
  }

  // ì¤‘ë³µ ì•„ì´í…œë§Œ ê²°ê³¼ì°½ì— í‘œì‹œ
  if (duplicateItems.length > 0) {
    showDrawResults(duplicateItems);
  }
}



     

    function showDrawResults(items) {
  const resultGrid = document.getElementById("resultGrid");
  resultGrid.innerHTML = "";

  items.forEach(item => {
    const grade = grades[item.grade];
    const card = document.createElement("div");
    card.className = "result-card";
    card.innerHTML = `
      <img src="${item.image}" />
      <div style="color: ${grade.color}; font-weight: bold;">${item.name}</div>
    `;
    resultGrid.appendChild(card);
  });

  document.getElementById("multiDrawMessage").textContent = `ğŸ 10íšŒ ë½‘ê¸° ê²°ê³¼ (${items.length}ê°œ)`;
  document.getElementById("drawResults").style.display = "flex";
}


    function hideDrawResults() {
      document.getElementById("drawResults").style.display = "none";
    }

    function playDrawSound() {
      const sound = document.getElementById("soundStart");
      try {
        sound.currentTime = 0;
        sound.play();
      } catch (e) {}
    }

    document.querySelectorAll(".box-option").forEach(option => {
      option.onclick = () => {
        document.querySelectorAll(".box-option").forEach(o => o.classList.remove("selected"));
        option.classList.add("selected");
        selectedBoxState.value = option.dataset.box;
        updateDrawCostText();
      };
    });

    async function tryDraw(times) {
      playDrawSound();
      await draw(times);
    }

    document.getElementById("draw1Btn").onclick = () => tryDraw(1);
    document.getElementById("draw10Btn").onclick = () => tryDraw(10);

    initCoins();
    initInventory();
    updateCoinDisplay();
    updateDrawCostText();
  </script>
</body>
</html>

